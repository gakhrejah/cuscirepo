version: 2.1
jobs:
  build:
    docker:
      - image: google/cloud-sdk
    steps:       
      - checkout             
      - setup_remote_docker
      - run: 
          name: building the image 
          command: |
            gcloud auth configure-docker --quiet
            SHORT_HASH=$(echo $CIRCLE_SHA1 | cut -c -7)      
            docker build -t asia.gcr.io/circlecisetup/allimages:${SHORT_HASH} .
